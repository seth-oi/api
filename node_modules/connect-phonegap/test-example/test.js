var phonegap = require('../');

startServer(function() {
  setTimeout(startServer, 1000);
});

function startServer(callback) {
  callback = callback || function() {};

  phonegap
    .listen()
    .on('complete', function(data) {
      console.log('Server is now running');

      console.log('Waiting 3s...');
      setTimeout(function() {
        data.server.close();
      }, 3000);
    })
    .on('error', function(e) {
      console.error('Unexpected error:', e.message);
    })
    .on('close', function() {
      console.log('Server is now shutdown');
      callback();
    });
}
